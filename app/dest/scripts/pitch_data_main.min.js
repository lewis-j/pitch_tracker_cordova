const url="http://localhost:81/pitch_tracker_cordova/php/";function initMenu(){function e(){document.getElementById("left-nav-menu").style.left="-18vw",document.removeEventListener("click",t,!0)}function t(t){var n=document.getElementById("left-nav-menu");t.target===n||n.contains(t.target)||(console.log("event clicked"),e())}console.log("reading new pitch"),document.getElementById("left-nav-menu").style.left="-18vw",$("#menu-btn").click(function(){"-18vw"==document.getElementById("left-nav-menu").style.left?(document.getElementById("left-nav-menu").style.left="0px",document.addEventListener("click",t,!0)):e()}),$("#edit-roster").click(e=>{window.location.href="roster_edit.html"}),$("#cubs-pitch").click(e=>{window.location.href="pitch_data.html"}),$("#pitch-tracker").click(e=>{window.location.href="../index.html"})}window.addEventListener("load",initMenu,!1),$(function(){$("#modal-container").append('<div class="modal" tabindex="-1" role="dialog" id="login-modal">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h5 class="modal-title">Login to access feature</h5>\n          <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n            <span aria-hidden="true">&times;</span>\n          </button>\n        </div>\n        <div class="modal-body" id="login-body">\n          <form id="login-form">\n    <div class="form-group">\n      <label for="userName">Username</label>\n      <input type="text" class="form-control" id="userName" placeholder="Enter email" name="username">\n    </div>\n    <div class="form-group">\n      <label for="password">Password</label>\n      <input type="password" class="form-control" id="password" placeholder="Password" name="password">\n    </div>\n    <button id="login-submit" type="submit" name="login-submit" class="btn btn-primary">Submit</button>\n    <p>Don\'t have an account?<a id="sign-up"> Sign up</a></p>\n  </form>\n        </div>\n      </div>\n    </div>\n  </div>\n'),$("#modal-container").append('<div class="modal" tabindex="-1" role="dialog" id="register-modal">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title">Sign Up</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" id="register-body">\n        <form id="register-form">\n  <div class="form-group">\n    <label for="userName">Username</label>\n    <input type="text" class="form-control" id="userName" placeholder="Enter userName" name="username">\n  </div>\n  <div class="form-group">\n    <label for="userName">Email</label>\n    <input type="email" class="form-control" id="email" placeholder="Enter email" name="email">\n  </div>\n  <div class="form-group">\n  <label for="role">Role</label>\n  <select id="role" class="form-control">\n    <option selected>Player</option>\n    <option>Coach</option>\n  </select>\n  </div>\n  <div class="form-group">\n    <label for="password">Password</label>\n    <input type="password" class="form-control" id="pwd" placeholder="Password" name="pwd">\n  </div>\n  <div class="form-group">\n    <label for="confirmPwd">Confirm Password</label>\n    <input type="password" class="form-control" id="confirmPwd" placeholder="confirm password" name="confirmPwd">\n  </div>\n  <button id="register-submit" type="submit" name="register-submit" class="btn btn-primary">Submit</button>\n</form>\n      </div>\n    </div>\n  </div>\n</div>\n'),$("#login-form").submit(e=>{var t=$("#modal-container").attr("data-callback");console.log("form submitted",t);var n=`username=${$("#userName").val()}&password=${$("#password").val()}&login-submit=submit`;console.log("params",n);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("login response",o.response);var e=JSON.parse(o.response);if(console.log("length of errors:",Object.entries(e.errors).length),0!==Object.entries(e.errors).length){var n=e.errors;for(const e in n)$("#login-body").prepend(`<div class=alert-danger>${n[e]}</div>`)}else $("#login-modal").modal("toggle"),window[t].call()}},o.onerror=function(){console.error("** An error occurred during the transaction",o.response)},o.open("POST",url+"SQLConnect.inc.php"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(n),e.preventDefault()}),$("#register-form").submit(e=>{console.log("form submitted");var t=`username=${$("#userName").val()}&password=${$("#pwd").val()}&confirmPassword=${$("#confirmPwd").val()}&email=${$("#email").val()}&role=${$("#role").val()}&register-submit=submit`;console.log("params",t);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("login response",n.response),console.log("login response",JSON.parse(n.response));var e=JSON.parse(n.response);if(0!==Object.entries(e.errors).length!==0){var t=e.errors;for(const e in t)$("#register-body").prepend(`<div class=alert-danger>${t[e]}</div>`)}else $("#register-modal").modal("toggle")}},n.onerror=function(){console.error("** An error occurred during the transaction",n.response)},n.open("POST",url+"SQLConnect.inc.php"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(t),e.preventDefault()}),$("#logout").click(()=>{var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&window.open("../index.html","_self")},e.onerror=function(){console.error("** An error occurred during the transaction",e.response)},e.open("POST",url+"logout.php"),e.send()}),$("#sign-up").click(()=>{$("#login-modal").modal("toggle"),$("#register-modal").modal("toggle")})});var rosterList=[],colors=["red","blue","green","purple","orange"];function OnDeviceReady(){getSeason(),console.log("device ready"),document.getElementById("season-select").addEventListener("change",e=>{getPlayers(rosterList[e.target.options.selectedIndex]),console.log("change event fired!",rosterList[e.target.options.selectedIndex])}),document.getElementById("edit-roster").addEventListener("click",e=>{window.open("./roster_edit.html")})}function getStats(e){e.preventDefault();var t=document.getElementById("pitcherSelect").options,n=t[t.selectedIndex].dataset.id;getPitchersData(t[t.selectedIndex].innerHTML,{player_id:n,options:["`srjc_game-pitches`.`firstpitch` =  '1'","`srjc_game-pitches`.`batterhandness` =  'Right'","`srjc_game-pitches`.`batterhandness` =  'Left'"],titles:["All Pitches","First Pitches","Right Handed Hitters","Left Handed Hitters"]})}function getPitchersData(e,t){console.log("sqldata",t);var n=new XMLHttpRequest;n.open("POST",url+"pitch_data.php"),n.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var t=JSON.parse(n.response);createView(e,t)}},n.onerror=function(){console.error("** An error occurred during the transaction")},n.send(JSON.stringify(t))}function createView(e,t){var n=t[n]||null;n=!0;$("#statTables").empty(),console.log("create view:",t);var o="";o=`<h1 id='pitcher-title'>${e}</h3>`;t.forEach(({tableTitle:t,data:r,coords:s},l)=>{o+=`<div class='row table-group'><div class='col-md-${s?"7":"12"}'>`,o+=`<div class='col-sm-12'><div class='pitcher-name'>${e}</div> <div class='${n?"title":"game-title"}'>${t}</div></div>`;var{metaStats:a,pitchTypes:i}=r,{allBats:d,allStrikes:c,allWalks:p,allHits:m}=a;o+=`<div class='my-tables row'><table class='game-stat table table-striped table-border  table-sm'><thead><tr>\n  <th scope='col'>Hitters</th><th scope='col'>Strike Outs</th><th scope='col'>Walks</th><th scope='col'>Hits</th></tr></thead><tbody>\n    <tr>\n               <td>${d}</td>\n               <td>${c}</td>\n               <td>${p}</td>\n               <td>${m}</td>\n          </tr>\n          </tbody></table></div>\n          <div class='row'>\n                <div class='col-md-1'>\n                <table class='table table-striped table-sm key'>\n                <tbody>\n                <tr>\n                 <th scope='row'>${i[0].title}</th>\n                </tr>\n                <tr>\n                 <th scope='row'>${i[1].title}</th>\n                </tr>\n                <tr>\n                 <th scope='row'>${i[2].title}</th>\n                </tr>\n                <tr>\n                 <th scope='row'>${i[3].title}</th>\n                </tr>\n                <tr>\n                 <th scope='row'>${i[4].title}</th>\n                </tr>\n                 <tr>\n                 <th scope='row'>${i[5].title}</th>\n                </tr>\n                </tbody>\n                </table>\n                </div>\n\n  <div class='my-tables col-md-6'><table class='table table-striped table-border table-sm'>\n    <thead>\n       <tr><th scope='col'></th>\n      <th scope='col' colspan='3'>Pitch Strike %</th>\n    </tr>\n    <tr>\n      <th scope='col'>PITCHES</th>\n      <th scope='col'>STRIKES</th>\n      <th scope='col'>BALLS</th>\n      <th scope='col'>STRIKE %</th>\n  </tr>\n  </thead>\n  <tbody>`;var h="",u="";if(i.forEach(({title:e,total:t,balls:n,strikes:o,strikePerc:r,minSp:s,maxSp:l,avgSp:a,totalBat:i})=>{h+=`<tr>\n               <td>${t}</td>\n               <td>${o}</td>\n               <td>${n}</td>\n               <td>${r}</td>\n          </tr>`,u+=`<tr>\n               <td>${s}</td>\n               <td>${l}</td>\n               <td>${a}</td>\n          </tr>`}),o+=h+"</tbody></table></div><div class='my-tables col-md-5'>\n          <table class='table table-striped table-border table-sm'>\n   <thead>\n      <tr>\n      <th scope='col'></th>\n      <th scope='col' colspan='3'>Pitch Velocity</th>\n      </tr>\n      <tr>\n      <th scope='col'>MIN</th>\n      <th scope='col'>MAX</th>\n      <th scope='col'>AVE</th>\n      </tr>\n  </thead>\n  <tbody>"+u+"</tbody></table></div></div></div>",s){var g=`mySVG${l}`;o+=`<div class="chart-data col-md-5">\n                      <div class="chart-key">\n                <table class='table table-striped table-border table-sm key2'>\n                  <thead>\n                    <tr>\n                      <th scope="row">Key</th>\n                    </tr>\n                  </thead>\n                <tbody>\n                <tr>\n                 <th scope='row'><div class ="legend-item" style="background-color:${colors[0]}">FB</div></th>\n                </tr>\n                <tr>\n                  <th scope='row'><div class ="legend-item" style="background-color:${colors[1]}">CB</div></th>\n                </tr>\n                <tr>\n                <th scope='row'><div class ="legend-item" style="background-color:${colors[2]}">CH</div></th>\n                </tr>\n                <tr>\n                  <th scope='row'><div class ="legend-item" style="background-color:${colors[3]}">SL</div></th>\n                </tr>\n                <tr>\n                <th scope='row'><div class ="legend-item" style="background-color:${colors[4]}">OT</div></th>\n                </tr>\n                </tbody>\n                </table>\n                </div>\n          <svg class="cust-svg" width="432px" height="473px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g id="${g}">\n  <rect id="rect"  x="2%" y="0" width="96%" height="100%"\n  style="fill:white;stroke:rgba(0,0,0,0);stroke-width:2;fill-opacity:0.9;stroke-opacity:0.9" />\n    <rect x="25%" y="20%" width="50%" height="60%"\n  style="fill:white;stroke:black;stroke-width:3;fill-opacity:0.1;stroke-opacity:0.9" />\n  <line x1="50%" y1="20%" x2="50%" y2="80%" style="stroke:black;stroke-width:3" />\n  <line x1="25%" y1="40%" x2="75%" y2="40%" style="stroke:black;stroke-width:3" />\n</g>\n</svg>\n        </div></div>`,$("#statTables").append(o),plotPoints(s,colors,g),o=""}else o+="</div>"}),$("#statTables").append(o)}function plotPoints(e,t,n){console.log("coords",e);var o;console.log(e),e.forEach(e=>{"FB"==e.t?o=t[0]:"CB"==e.t?o=t[1]:"CH"==e.t?o=t[2]:"SL"==e.t?o=t[3]:"other"==e.t&&(o=t[4]),myCircle=document.createElementNS("http://www.w3.org/2000/svg","circle"),myCircle.setAttributeNS(null,"class","mycircle"),myCircle.setAttributeNS(null,"cx",e.x+"%"),myCircle.setAttributeNS(null,"cy",e.y+"%"),myCircle.setAttributeNS(null,"r",8),myCircle.setAttributeNS(null,"fill",o),myCircle.savedToGraph=!1,document.getElementById(n).appendChild(myCircle)})}function addPlayerFormOptions(e){var t=document.getElementById("pitcherSelect");t.innerHTML="",e.forEach(({_id:e,pitcher_name:n})=>{var o=document.createElement("option");o.setAttribute("data-id",e);var r=document.createTextNode(n);o.appendChild(r),console.log("new node:  ",o),t.appendChild(o)})}function addRosterFormOptions(e){e.forEach((e,t)=>{var n=document.createElement("option"),o=document.createTextNode(e.title+" "+e.season+" "+e.year);n.appendChild(o);var r=document.createAttribute("data-index");if(r.value=t,n.setAttributeNode(r),0==t){var s=document.createAttribute("selected");n.setAttributeNode(s)}document.getElementById("season-select").appendChild(n)})}function getPlayers(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&(console.log("RESPONSE::::::::::",t.response),addPlayerFormOptions(JSON.parse(t.response)))},t.onerror=function(){console.error("** An error occurred during the transaction")},console.log("roster data:  ",e),t.open("POST",url+"get_team_byid.php"),t.send(JSON.stringify(e))}function getSeason(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("RESPONSE roster list  :  ",e.response);var t=JSON.parse(e.response);t.loggedIn?(rosterList=t.teamList,console.log("roster list  :  ",rosterList),addRosterFormOptions(rosterList),getPlayers(rosterList[0])):(console.log("open modal",$("#login-modal")),$("#login-modal").modal("toggle"))}e.onerror=function(){console.error("** An error occurred during the transaction",e.response)}},e.open("POST",url+"get_team_list.php"),e.send()}window.addEventListener("load",OnDeviceReady);
const url="http://localhost:81/pitch_tracker_cordova/php/";function storeData(e){return console.log("storeData"),xhrPost(e,"store_player_data.php")}function bulkStoreData(e){return console.log("bulkStoreData"),xhrPost(e,"store_pitch_data.php")}function getRosterList(){return console.log("getRosterList"),xhrPost(null,"get_team_list.php")}function getRoster(){return console.log("getRoster"),xhrPost(null,"get_team.php")}function xhrPost(e,t){return new Promise(function(n,o){var r=new XMLHttpRequest;r.open("POST",url+t),r.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(200===this.status){console.log("xhttp Response:",r.response);var e=JSON.parse(r.response);console.log("response object",e),e.loggedIn?n(e):o(JSON.stringify({loggedIn:!1}))}else o({status:r.status,statusText:r.statusText})},r.onerror=function(){console.error("** An error occurred during the transaction")},r.send(JSON.stringify(e))})}var pitchersDB=new PouchDB("pitchers"),pitchesDB=new PouchDB("pitch"),rostlistDB=new PouchDB("roster_list"),rostDB=new PouchDB("roster"),userDB=new PouchDB("user");function getPouchRosterList(){return new Promise((e,t)=>{rostlistDB.info().then(t=>new Promise((n,o)=>{0===t.doc_count?n():rostlistDB.allDocs({include_docs:!0,startkey:"_",descending:!0}).then(t=>{e(t.rows),o("returned from db.info() promise")})})).then(e=>getRosterList()).then(e=>rostlistDB.bulkDocs(e.teamList)).then(e=>rostlistDB.allDocs({include_docs:!0,descending:!0})).then(t=>{e(t.rows)}).catch(e=>{t("Error in pouchDBTransfer: "+e)})})}function getPouchRoster(e){return new Promise((t,n)=>{rostDB.info().then(n=>new Promise((o,r)=>{0===n.doc_count?o():rostDB.createIndex({index:{fields:["team_id"]}}).then(t=>rostDB.find({selector:{team_id:e}})).then(e=>{t(e.docs),r("returned from db.info() promise")})})).then(e=>getRoster()).then(e=>(console.log("object returend",e),rostDB.bulkDocs(e.teamList))).then(()=>rostDB.createIndex({index:{fields:["team_id"]}})).then(t=>rostDB.find({selector:{team_id:e}})).then(e=>{t(e.docs)}).catch(e=>{n(e)})})}function deletePouchPitches(e){pitchesDB.find({selector:{pitcher_id:e}}).then(t=>(console.log("pitch data to delete:",t.docs),t.docs.forEach(function(e){console.log("item",e),pitchesDB.remove(e)}),pitchersDB.get(e).then(e=>{pitchersDB.remove(e)}))).then(()=>{}).catch(e=>{console.error("error in pouchDBTransfer deletepouchpitch",e)})}function getPouchPitcher(e=-1){return-1==e?pitchersDB.allDocs({include_docs:!0,limit:1,descending:!0}).then(e=>e.rows[0].doc):pitchersDB.get(e).then(e=>(console.log("getPouchPitcher:",e._id),e))}function getPouchPitchers(){return pitchersDB.allDocs({include_docs:!0,descending:!0}).then(e=>e.rows)}function pouchHasPitcher(){return pitchersDB.allDocs({include_docs:!0,limit:1,descending:!0}).then(e=>0!=e.total_rows)}function getPouchPitches(e){return pitchesDB.createIndex({index:{fields:["pitcher_id"]}}).then(t=>pitchesDB.find({selector:{pitcher_id:e}}))}function storePouch(e){switch(console.log("data object: ",e.objType),e.objType){case"1":return pitchersDB.put(e);case"2":return pitchesDB.put(e)}}function transferPouchToSql(){return new Promise((e,t)=>{pitchersDB.allDocs({include_docs:!0}).then(e=>(console.log(e.total_rows),e.rows.reduce((e,t)=>(console.log("docitem",t.doc),e.then(e=>storeData(t.doc)).then(e=>pitchesDB.createIndex({index:{fields:["pitcher_id"]}})).then(function(){return console.log("DOCITEM:",t.doc),pitchesDB.find({selector:{pitcher_id:t.doc.pitcher_id}})}).then(e=>(console.log("item for bulkStoreData:",e.docs),bulkStoreData(e.docs).then(e=>{console.log("response from bulk store:",e)})))),Promise.resolve()))).then(t=>{console.log("db destroyed"),pitchersDB.destroy().then(e=>{pitchersDB=new PouchDB("pitchers")}),pitchesDB.destroy().then(e=>{pitchesDB=new PouchDB("pitch")}),e("Success!")}).catch(e=>{console.log("no pitchers saved!:",e),t(e)})})}function syncRoster(){return new Promise((e,t)=>{rostDB.destroy().then(e=>(rostDB=new PouchDB("roster"),getRoster())).then(e=>rostDB.bulkDocs(e.teamList)).then(()=>rostlistDB.destroy()).then(e=>(rostlistDB=new PouchDB("roster_list"),getRosterList())).then(e=>rostlistDB.bulkDocs(e.teamList)).then(e=>rostlistDB.allDocs({include_docs:!0,descending:!0})).then(t=>{console.log("found list: ",t),e(t.rows)}).catch(e=>{t(e)})})}function initUserInteractions(){$(".login-btn").click(()=>{console.log("login btn pressed"),$("#login-modal").modal("toggle")}),$(".signup-btn").click(()=>{$("#register-modal").modal("toggle")}),$(".signout-btn").click(()=>{var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&window.open("./index.html","_self")},e.onerror=function(){console.error("** An error occurred during the transaction",e.response)},e.open("POST",url+"logout.php"),e.send()})}function initIndex(){const e=["red","blue","green","purple","orange"];document.body.style.setProperty("--FB-color",e[0]),document.body.style.setProperty("--CH-color",e[1]),document.body.style.setProperty("--SL-color",e[2]),document.body.style.setProperty("--CB-color",e[3]),document.body.style.setProperty("--OT-color",e[4]);var t={objType:"1",startingPitcher:!0},n=[],o=$("#header-title").height();document.querySelectorAll(".clear-header").forEach((e,t)=>{console.log("elements",o),e.style.setProperty("--header-height",o+"px")}),scalePitchGraph(),window.addEventListener("resize",()=>{scalePitchGraph()});var r,s,i,c,l,a,d=!1,u={totalStrikes:0,totalBalls:0,pitchCount:0,ballCount:0,strikeCount:0},m=new PouchDB("pitch"),p=!0,h=!1,g=0,y=[];function f(){var o={objType:"2"};if(function(){var e=!0;p&&(alert("No coordinate point added to pitch zone! Add a coordinate to continue."),e=!1);0==g&&(document.getElementById("mph-ui").classList.add("ui_invalid"),e=!1);var t=document.querySelectorAll("#batter-handedness label");document.getElementById("switch_lhh").checked||document.getElementById("switch_rhh").checked?t.forEach(function(e){e.classList.remove("ui_invalid")}):(t.forEach(function(e){e.classList.remove("ui_invalid"),setTimeout(function(){e.classList.add("ui_invalid")},1)}),e=!1);for(var n=document.getElementsByName("switch_pitch"),o=!1,r=0;r<n.length;r++)n[r].checked&&(o=!0);if(!o){e=!1;var s=document.querySelectorAll("#pitch-fields label");s.forEach(function(e){e.classList.add("ui_invalid")})}return e}()){o.xCoord=r.getAttributeNS(null,"cx"),o.yCoord=r.getAttributeNS(null,"cy"),(o.firstPitch=document.getElementById("first-pitch").checked)&&(document.getElementById("first-pitch").checked=!1),document.getElementById("switch_lhh").checked?o.batterHandedness="Left":document.getElementById("switch_rhh").checked&&(o.batterHandedness="Right");for(var s=document.getElementsByName("switch_play"),i=0;i<s.length;i++)s[i].checked&&(s[i].checked=!1,o.play=s[i].getAttribute("value"),"Strike"==o.play?(u.totalStrikes++,u.strikeCount++):(u.totalBalls++,u.ballCount++));for(s=document.getElementsByName("switch_pitch"),i=0;i<s.length;i++)s[i].checked&&(s[i].checked=!1,o.pitchType=s[i].getAttribute("value"),o.pitchColor=e[i]);s=document.getElementsByName("switch_end");o.endPlay="continue";for(i=0;i<s.length;i++)s[i].checked&&(s[i].checked=!1,o.endPlay=s[i].getAttribute("value"),document.getElementById("first-pitch").checked=!0,k(),u.ballCount=0,u.strikeCount=0);o.pitchSpeed=g,document.getElementById("mph-text").innerHTML="00",g=0,r.savedToGraph=!0,u.pitchCount++,o.gameCount=u,o.date=B("yyyy/mm/dd"),o.timeStamp=w(),r.setAttributeNS(null,"fill",o.pitchColor),p=!0,d?(d=!1,o._id=new Date,t._id=new Date,o.pitcher_id=t._id,storePouch(t).then(function(e){return storePouch(o)}).catch(function(e){console.error(e)})):(o._id=new Date,o.pitcher_id=t._id,storePouch(o).catch(e=>{console.error(e)})),n.push(o),N(u)}}function b(){y.length>0&&(delete y[y.length-1].pitchData._rev,N(u=y[y.length-1].pitchData.gameCount),n.push(y[y.length-1].pitchData),storePouch(y[y.length-1].pitchData,"pitch").catch(e=>{console.error(e)}),document.getElementById("mySVG").appendChild(y[y.length-1].circle),y.pop())}function v(e){return e.ballCount=0,e.strikeCount=0,e.totalBalls=0,e.totalStrikes=0,e.pitchCount=0,e}function w(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}function B(e){var t=new Date,n=t.getDate(),o=t.getMonth()+1,r=t.getFullYear();return n<10&&(n="0"+n),o<10&&(o="0"+o),"yyyy/mm/dd"===e?r+"/"+o+"/"+n:o+"/"+n+"/"+r}function k(){document.getElementById("switch_rhh").checked=!1,document.getElementById("switch_lhh").checked=!1,document.getElementById("right-batter").style.display="none",document.getElementById("left-batter").style.display="none"}!function(e){var t=d3.select("#strike-pie"),n=t.attr("width"),o=t.attr("height"),r=Math.min(n,o)/2,d=t.append("g").attr("transform","translate("+n/2+","+o/2+")");d.append("circle").attr("cx",0).attr("cy",0).attr("r",r).attr("fill","#F1F1F1"),a=t.append("text").attr("transform","translate("+n/2+","+o/5+")").attr("dy","2em").attr("text-anchor","middle").style("font-size","15px").style("text-decoration","bold").text("$");var u=d3.scaleOrdinal(["#A70415","#15172C"]);c=d3.pie(),i=d3.arc().innerRadius(.7*r).outerRadius(r),(s=d.selectAll("arc").data(c(e)).enter().append("g").attr("class","arc")).transition().duration(500).attr("fill",function(e,t){return u(t)}).attr("d",i).each(function(e){this._current=e}),s.append("path").attr("fill",function(e,t){return u(t)}).attr("d",i),l=t.selectAll("path")}([0,0]),x([0,1]),$("#mySVG").click(e=>{var t=e.target.getBoundingClientRect(),n=document.getElementById("rect").getBoundingClientRect(),o=((e.clientX-n.left)/(n.right-n.left)*100).toString()+"%",s=((e.clientY-n.top)/(n.bottom-n.top)*100).toString()+"%";t.left===n.left?(document.getElementById("switch_ball").checked=!0,u.ballCount):(document.getElementById("switch_stk").checked=!0,u.strikeCount),h&&($("#data-entry").text("Enter"),$("#data-entry").off("click"),$("#data-entry").on("click",f),h=!1,p=!0,y=[]),p?((r=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttributeNS(null,"class","mycircle"),r.setAttributeNS(null,"cx",o),r.setAttributeNS(null,"cy",s),r.setAttributeNS(null,"r",8),r.setAttributeNS(null,"fill","black"),r.savedToGraph=!1,document.getElementById("mySVG").appendChild(r),p=!1,"mph-slide"!=document.getElementById("mph-dropdown").classList.value&&document.getElementById("mph-dropdown").classList.toggle("mph-slide")):(r.setAttributeNS(null,"cx",o),r.setAttributeNS(null,"cy",s))}),$("#data-entry").on("click",f),$("#undo-entry").click(e=>{if(n.length>0){var t=document.getElementsByClassName("mycircle"),o=t[t.length-1];o.savedToGraph&&(m.allDocs({include_docs:!0,startkey:"_",limit:2,descending:!0}).then(e=>(0==n.length?N(v(u)):N(u=e.rows[1].doc.gameCount),m.get(e.rows[0].id))).then(e=>(y.push({circle:o,pitchData:e}),m.remove(e))).catch(e=>{console.error(e)}),n.pop()),h||($("#data-entry").text("Redo"),$("#data-entry").off("click"),$("#data-entry").on("click",b),h=!0),o.parentNode.removeChild(o)}});var E=[];getPouchRosterList().then(e=>(e.forEach((t,n)=>{t=t.doc,e.length-1==n?($("#roster-list").append("<option selected data-id="+t._id+">"+t.year+" "+t.season+" "+t.title+"</option"),rosterIndex=parseInt(t._id)):$("#roster-list").append("<option data-id="+t._id+">"+t.year+" "+t.season+" "+t.title+"</option")}),getPouchRoster(1))).then(e=>{E=e,e.forEach(e=>{$("#pitcher-name").append("<option data-id="+e._id+">"+e.pitcher_name+"</option")})}).catch(e=>{console.log("login test",e),console.error(e)}),$("#roster-list").change(e=>{getPouchRoster(parseInt(e.target.options[e.target.selectedIndex].dataset.id)).then(e=>{$("#pitcher-name").empty(),$("#pitcher-name").append("<option selected disabled value='unselected'><i>Select Pitcher</i></option>"),E=e,e.forEach(e=>{$("#pitcher-name").append("<option data-id="+e._id+">"+e.pitcher_name+"</option")})})});["SRJC","Chabot","De Anza","Marin","Laney","Canada","Solano","Contra Costa","Cabrillo","San Juaquin Delta","Modesto","Diablo Valley","Folsom Lake","American River","Cosumnes River","Monterey Peninsula","Sacromento City","Seirra"].forEach(e=>{$("#op-team-name").append(`<option>${e}</option`)});var _,D,C=!0,I=!1;function P(){var e;getPouchPitchers().then(o=>{var s=document.getElementById("transfer-edit-content"),i=document.createElement("button");i.setAttribute("class","delete-pouch"),o.forEach(e=>{playerInfo=e.doc,tr=document.createElement("tr"),tr.setAttribute("class","row-items"),tr.setAttribute("data-id",playerInfo._id),td=document.createElement("td"),td.innerHTML=playerInfo.playerName,tr.appendChild(td),td=td.cloneNode(!0),td.innerHTML=playerInfo.date,tr.appendChild(td),td=td.cloneNode(!0),td.innerHTML=playerInfo.gameType,tr.appendChild(td),td=td.cloneNode(!0),td.innerHTML=playerInfo.opponent,(i=i.cloneNode(!0)).innerHTML="Delete",tr.appendChild(td),tr.appendChild(i),s.appendChild(tr)}),$(".row-items").click(o=>{A(),getPouchPitcher(o.target.parentNode.dataset.id).then(n=>(e=n,$("#start-background").css("width","0"),t._id=n._id,getPouchPitches(n._id))).then(t=>{var o=n=t.docs;S(e,o[o.length-1]),u=o[o.length-1].gameCount,o.forEach(e=>{(r=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttributeNS(null,"class","mycircle"),r.setAttributeNS(null,"cx",e.xCoord),r.setAttributeNS(null,"cy",e.yCoord),r.setAttributeNS(null,"r",8),r.setAttributeNS(null,"fill",e.pitchColor),r.savedToGraph=!0,document.getElementById("mySVG").appendChild(r),p=!0})}).catch(e=>{console.error(e)}),H($("#transfer-edit-screen"))}),$(".delete-pouch").click(e=>{e.stopPropagation();var t=e.target.parentNode.children,n=e.target.parentNode.parentNode.parentNode.children[0].children[0].children,o=document.createElement("table");o.setAttribute("class","game-stat table table-striped table-border  table-sm");for(var r=document.createElement("tbody"),s=0;s<t.length-1;s++){var i=document.createElement("tr"),c=document.createElement("th"),l=document.createElement("th");c.innerHTML=`${n[s].innerHTML}`,l.innerHTML=t[s].innerHTML,i.appendChild(c),i.appendChild(l),r.appendChild(i),o.appendChild(r)}document.getElementById("delete-local-modal-body").innerHTML="",document.getElementById("delete-local-modal-body").appendChild(o),document.getElementById("confirm-local-delete").setAttribute("data-id",e.target.parentNode.dataset.id),$("#delete-local-modal").modal("show")})}).catch(e=>{console.error("Error in script.js:",e)})}function S(e,t){$("#date").text(e.date),$("#game-type-dspy").text(e.gameType),$("#pitcher-name-dspy").text(e.playerName),$("#op-team-name-dspy").text(e.opponent),N(t.gameCount)}function x(e){var t=0,n=e[0]+e[1];l.data(c(e)),l.transition().duration(750).attrTween("d",L),0!=n&&(t=e[0]/n*100),a.text(t.toFixed(1)+"%")}function L(e){var t=d3.interpolate(this._current,e);return this._current=t(1),function(e){return i(t(e))}}function N(e){$("#pitch-count").text(e.pitchCount),$("#total-balls").text(e.totalBalls),$("#total-strikes").text(e.totalStrikes),$("#balls").text(e.ballCount),$("#strikes").text(e.strikeCount),x([e.totalStrikes,e.totalBalls])}function T(e){e.addClass("page-transition"),e.hasClass("menu-page-open")&&e.removeClass("menu-page-open"),z(),setTimeout(()=>{e.removeClass("page-transition")},1e3)}function A(){var e=document.getElementsByClassName("mycircle");if(e.length>0){for(var t=e.length-1;t>=0;t--)document.getElementById("mySVG").removeChild(e[t]);p=!0}}function R(){lnm=document.getElementById("left-nav-menu"),lnm.classList.add("lnm-opened"),document.addEventListener("click",O,!0),console.log("openeing left nav"),$(this).addClass("open"),$(this).one("click",M)}function M(){console.log("closing left nav"),H($(".menu-page-open")),$(this).removeClass("open"),$(this).one("click",R)}function H(e){var t;e.bind("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",F),e.bind("animationstart webkitAnimationStart oanimationstart  msAnimationStart ",q),(t=e).css("animation","close-window .5s forwards"),t.css("-webkit-animation","close-window .5s forwards"),console.log("in closeAllMenus",e),z()}function F(e){var t;console.log("ended animation",e.target.style),t=$(e.target),console.log("unsetting animation",t),t.css("animation",""),t.css("-webkit-animation",""),$("#left-nav-menu").removeClass("lnm-opened"),$(e.target).removeClass("menu-page-open"),$(e.target).removeClass("full-open-menu")}function q(e){console.log("started animation",$(e.target))}function O(e){var t=[document.getElementById("left-nav-menu"),document.getElementById("transfer-edit-screen"),document.getElementById("select-pitcher-screen")];t.length!==t.reduce((t,n)=>e.target===n||n.contains(e.target)?t:t+1,0)||$("#left-nav-menu").removeClass("lnm-opened")}function z(){document.removeEventListener("click",O,!0)}$("#HUD-2 g ").click(function(e){var t=$(this)[0].lastElementChild.innerHTML;C?(g=0,g=t,C=!1,(_=this.children[0].style).fill="red"):(g+=t,document.getElementById("mph-dropdown").classList.toggle("mph-slide"),C=!0,_.fill="white",document.getElementById("mph-text").innerHTML=g,document.getElementById("mph-ui").classList.remove("ui_invalid"))}),$("#mph-ui").click(function(e){document.getElementById("mph-dropdown").classList.toggle("mph-slide")}),$("#batter-handedness input").click(e=>{document.querySelectorAll("#batter-handedness label").forEach(function(e){e.classList.remove("ui_invalid")}),"switch_lhh"===e.target.id?(document.getElementById("right-batter").style.display="none",document.getElementById("left-batter").style.display="block"):(document.getElementById("left-batter").style.display="none",document.getElementById("right-batter").style.display="block")}),$("#pitch-fields input").click(()=>{document.querySelectorAll("#pitch-fields label").forEach(function(e){e.classList.remove("ui_invalid")})}),$("#new-btn").click(e=>{$("#opening-menu").css("display","none"),$("#select-menu").css("display","block")}),$("#new-btn-back").click(e=>{$("#opening-menu").css("display","block"),$("#select-menu").css("display","none")}),$("#database-btn").click(()=>{window.location.href="links/pitch_data.html"}),$("#start-btn").click(()=>{var e=!0;document.getElementById("pitcher-name").selectedIndex-1!=-1?(t.playerName=E[document.getElementById("pitcher-name").selectedIndex-1].pitcher_name,t.player_id=E[document.getElementById("pitcher-name").selectedIndex-1]._id,document.getElementById("game-type").selectedIndex-1!=-1?(t.gameType=$("#game-type").val(),"Game"==$("#game-type").val()?document.getElementById("op-team-name").selectedIndex-1!=-1?(t.opponent=$("#op-team-name").val(),t.gameNum=$("#game-num").val()):(document.getElementById("op-team-name").classList.add("ui_invalid"),e=!1):(t.opponent=$("#game-type").val(),t.gameNum="1")):(document.getElementById("game-type").classList.add("ui_invalid"),e=!1)):(document.getElementById("pitcher-name").classList.add("ui_invalid"),e=!1),e&&(d=!0,$("#start-background").css("display","none"),document.getElementById("first-pitch").checked=!0,t.objType="1",t.date=B("yyyy/mm/dd"),t.timeStamp=w(),S(t,{gameCount:u}))}),$("#sync-roster").click(function(){syncRoster().then(e=>($("#roster-list").empty(),e.forEach((t,n)=>{t=t.doc,e.length-1==n?($("#roster-list").append("<option selected data-id="+t._id+">"+t.year+" "+t.season+" "+t.title+"</option"),rosterIndex=parseInt(t._id)):$("#roster-list").append("<option data-id="+t._id+">"+t.year+" "+t.season+" "+t.title+"</option")}),getPouchRoster(1))).then(e=>{E=e,$("#pitcher-name").empty(),$("#pitcher-name").append("<option selected disabled value='unselected'><i>Select Pitcher</i></option>"),e.forEach(e=>{$("#pitcher-name").append("<option data-id="+e._id+">"+e.pitcher_name+"</option")})}).catch(e=>{jsonChecker(e)?loginCheck(e,"fetchRosterList"):console.error(e)})}),$("#pitcher-name").change(e=>{$("#game-type-group").css("opacity","1"),$("#game-type-group").css("visibility","visible")}),$("#pitcher-name").click(e=>{$("#pitcher-name").removeClass("ui_invalid")}),$("#game-type").change(e=>{"Game"==e.target.value?($("#op-team-group").css("opacity","1"),$("#op-team-group").css("visibility","visible")):($("#op-team-group").css("opacity","0"),$("#game-num-group").css("opacity","0"),$("#op-team-group").css("visibility","hidden"),$("#game-num-group").css("visibility","hidden"))}),$("#game-type").click(e=>{document.getElementById("game-type").classList.remove("ui_invalid")}),$("#op-team-name").change(e=>{$("#game-num-group").css("opacity","1"),$("#game-num-group").css("visibility","visible")}),$("#op-team-name").click(e=>{document.getElementById("op-team-name").classList.remove("ui_invalid")}),$("#load-btn").click(()=>{$("#transfer-edit-screen").addClass("full-open-menu"),$("#transfer-edit-content").empty(),P()}),$("#switch_stk").click(()=>{u.strikeCount}),$('[name="switch_end"]').on("click",e=>{e.target.clickedOnce?(e.target.clickedOnce=!1,e.target.checked=!1):$('[name="switch_end"]').each(e=>{$('[name="switch_end"]')[e].clickedOnce=!1}),e.target.checked&&(e.target.clickedOnce=!0)}),$("#switch-pitcher").click(function(){T($("#transfer-edit-screen")),$("#select-pitcher-screen").addClass("menu-page-open"),I||(I=!0,E.forEach(e=>{$("#new-pitcher-select").append(`<option>${e.pitcher_name}</option`)}))}),$("#transfer-data").click(()=>{T($("#select-pitcher-screen")),$("#transfer-edit-screen").addClass("menu-page-open"),$("#transfer-edit-content").empty(),P()}),$("#confirm-local-upload").click(e=>{uploadData()}),$("#confirm-local-delete").click(e=>{deletePouchPitches(e.target.dataset.id)}),$("#view-data").click(()=>{window.open("links/pitch_data.html","_self")}),$("#enter-new-pitcher").click(()=>{t.playerName=E[document.getElementById("new-pitcher-select").selectedIndex].pitcher_name,t.pitcher_id=E[document.getElementById("new-pitcher-select").selectedIndex]._id,t.startingPitcher=!1,A(),document.getElementById("left-nav-menu").style.left="-17vw",document.getElementById("select-pitcher-screen").style.left="-17vw",document.getElementById("select-pitcher-screen").style.width="0px",z(),setTimeout(()=>{document.getElementById("select-pitcher-screen").style.left="17vw"},1e3),k(),$("#pitcher-name-dspy").text(t.playerName),d=!0,N(v(u)),document.getElementById("first-pitch").checked=!0}),$("#menu-btn").one("click",R),$(".close-btn").click(function(e){H($(e.target.parentNode)),$("#menu-btn").removeClass("open").one("click",R)}),$("#fullscreen").click(e=>{document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?($("body").get(0),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e.target.classList.remove("fa-compress"),e.target.classList.add("fa-expand")):((D=$("body").get(0)).requestFullscreen?D.requestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.webkitRequestFullscreen?D.webkitRequestFullscreen():D.msRequestFullscreen&&D.msRequestFullscreen(),e.target.classList.remove("fa-expand"),e.target.classList.add("fa-compress"))})}function scalePitchGraph(){let e=window.innerHeight,t=$("#pitch-zone").width();$("#pitch-zone").height(e-$("#header-title").height()),e==Math.min(e,t)?($("#pitch-zone > svg").css("height","100%"),$("#pitch-zone > svg").css("width",.91*e),$("#pitch-zone > svg").css("margin-top",0)):($("#pitch-zone > svg").css("height",1.099*t),$("#pitch-zone > svg").css("width",t),$("#pitch-zone > svg").css("margin-top",.5*($("#pitch-zone").height()-$("#pitch-zone > svg").height())))}function uploadData(){document.getElementById("upload-btn").innerHTML="Uploading Pitch Data <div class='loader'></div>",transferPouchToSql().then(e=>{document.getElementById("upload-btn").innerHTML="Transfer Success",document.getElementById("upload-btn").setAttribute("class","btn btn-success"),setTimeout(()=>{window.open("./")},3e3)})}function jsonChecker(e){return/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}function loginCheck(e,t){JSON.parse(e).loggedIn?console.err(e):($("#modal-container").attr("data-callback",t),$("#login-modal").modal())}$(function(){$("#modal-container").append('<div class="modal" tabindex="-1" role="dialog" id="login-modal">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h5 class="modal-title">Login to access feature</h5>\n          <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n            <span aria-hidden="true">&times;</span>\n          </button>\n        </div>\n        <div class="modal-body" id="login-body">\n          <form id="login-form">\n    <div class="form-group">\n      <label for="userName">Username</label>\n      <input type="text" class="form-control" id="userName" placeholder="Enter email" name="username">\n    </div>\n    <div class="form-group">\n      <label for="password">Password</label>\n      <input type="password" class="form-control" id="password" placeholder="Password" name="password">\n    </div>\n    <button id="login-submit" type="submit" name="login-submit" class="btn btn-primary">Submit</button>\n    <p>Don\'t have an account?<a id="sign-up"> Sign up</a></p>\n  </form>\n        </div>\n      </div>\n    </div>\n  </div>\n'),$("#modal-container").append('<div class="modal" tabindex="-1" role="dialog" id="register-modal">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title">Sign Up</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body" id="register-body">\n        <form id="register-form">\n  <div class="form-group">\n    <label for="userName">Username</label>\n    <input type="text" class="form-control" id="userName" placeholder="Enter userName" name="username">\n  </div>\n  <div class="form-group">\n    <label for="userName">Email</label>\n    <input type="email" class="form-control" id="email" placeholder="Enter email" name="email">\n  </div>\n  <div class="form-group">\n  <label for="role">Role</label>\n  <select id="role" class="form-control">\n    <option selected>Player</option>\n    <option>Coach</option>\n  </select>\n  </div>\n  <div class="form-group">\n    <label for="password">Password</label>\n    <input type="password" class="form-control" id="pwd" placeholder="Password" name="pwd">\n  </div>\n  <div class="form-group">\n    <label for="confirmPwd">Confirm Password</label>\n    <input type="password" class="form-control" id="confirmPwd" placeholder="confirm password" name="confirmPwd">\n  </div>\n  <button id="register-submit" type="submit" name="register-submit" class="btn btn-primary">Submit</button>\n</form>\n      </div>\n    </div>\n  </div>\n</div>\n'),$("#login-form").submit(e=>{var t=$("#modal-container").attr("data-callback");console.log("form submitted",t);var n=`username=${$("#userName").val()}&password=${$("#password").val()}&login-submit=submit`;console.log("params",n);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("login response",o.response);var e=JSON.parse(o.response);if(console.log("length of errors:",Object.entries(e.errors).length),0!==Object.entries(e.errors).length){var n=e.errors;for(const e in n)$("#login-body").prepend(`<div class=alert-danger>${n[e]}</div>`)}else $("#login-modal").modal("toggle"),window[t].call()}},o.onerror=function(){console.error("** An error occurred during the transaction",o.response)},o.open("POST",url+"SQLConnect.inc.php"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(n),e.preventDefault()}),$("#register-form").submit(e=>{console.log("form submitted");var t=`username=${$("#userName").val()}&password=${$("#pwd").val()}&confirmPassword=${$("#confirmPwd").val()}&email=${$("#email").val()}&role=${$("#role").val()}&register-submit=submit`;console.log("params",t);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("login response",n.response),console.log("login response",JSON.parse(n.response));var e=JSON.parse(n.response);if(0!==Object.entries(e.errors).length!==0){var t=e.errors;for(const e in t)$("#register-body").prepend(`<div class=alert-danger>${t[e]}</div>`)}else $("#register-modal").modal("toggle")}},n.onerror=function(){console.error("** An error occurred during the transaction",n.response)},n.open("POST",url+"SQLConnect.inc.php"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(t),e.preventDefault()}),$("#logout").click(()=>{var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&window.open("../index.html","_self")},e.onerror=function(){console.error("** An error occurred during the transaction",e.response)},e.open("POST",url+"logout.php"),e.send()}),$("#sign-up").click(()=>{$("#login-modal").modal("toggle"),$("#register-modal").modal("toggle")})}),window.addEventListener("load",function(){initUserInteractions()},!1),window.addEventListener("load",function(){initIndex()},!1);